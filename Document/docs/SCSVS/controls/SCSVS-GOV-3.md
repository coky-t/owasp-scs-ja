# SCSVS-GOV-3

## S3.3 再入可能性とロジックの欠陥の防止 (Preventing Reentrancy and Logic Flaws)

### 管理目標
スマートコントラクトのトランザクションフローとロジックの完全性が再入攻撃やロジックの欠陥から保護されていることを確認します。コントラクトは堅牢な制御構造とセキュリティパターンを実装して、再入可能性を防ぎ、複雑なフローを処理し、状態遷移が安全かつ対照的であることを確保する必要があります。

### S3.3.A トランザクションフローのセキュリティ (Transaction Flow Security)

| **SCSVS&nbsp;VR&nbsp;ID** | 要件                                                                 | L1 | L2 | L3 | SWE |
| ------------------------- | -------------------------------------------------------------------- | -- | -- | -- | --- |
| S3.3.A1      | ループ制御構造のエッジケースをチェックして、break 文や continue 文による予期しない動作を防ぎます。 |    | ✓  | ✓  |     |
| S3.3.A2      | 送信者と受信者が同じであるシナリオを考慮して、スマートコントラクトでの意図しない問題を防いでいることを確認します。 |    | ✓  | ✓  |     |
| S3.3.A3      | 関数内で `NonReentrant` 修飾子が他の修飾子より前に適用され、再入攻撃を防いでいることを確認します。 |    | ✓  | ✓  |     |
| S3.3.A4      | check-effect-interaction パターンが実装され、再入攻撃を防いでいることを検証します。 |    | ✓  | ✓  |     |
| S3.3.A5      | 任意のユーザー入力と低レベルの呼び出しによる関数呼び出しが安全に処理され、リスクの発生を避けていることを確認します。 |    | ✓  | ✓  |     |

### S3.3.B 機能の完全性 (Function Integrity)

| **SCSVS&nbsp;VR&nbsp;ID** | 要件                                                                 | L1 | L2 | L3 | SWE |
| ------------------------- | -------------------------------------------------------------------- | -- | -- | -- | --- |
| S3.3.B1      | パラメータセットごとに一意であることを意図した関数が複数回呼び出されず、潜在的な問題を防いでいることを確認します。 |    | ✓  | ✓  |     |
| S3.3.B2      | 払い戻しや預け入れなどの関数の状態変化が対称的に処理され、一貫性がないことによる望ましくない動作を避けていることを検証します。 |    | ✓  | ✓  |     |
