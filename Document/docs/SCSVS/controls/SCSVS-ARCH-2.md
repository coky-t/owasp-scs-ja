# SCSVS-ARCH-2

## S1.2 プロキシパターン (Proxy Patterns)

### 管理目標
プロキシパターンとアップグレードメカニズムが安全に実装され、適切に管理されており、コントラクトアップグレード、廃止、コントラクトバージョン間の移行時のリスクを軽減していることを確認します。
### セキュリティ検証要件
### S1.2.A アップグレードメカニズム (Upgrade Mechanisms)

| **SCSVS&nbsp;VR&nbsp;ID** | 要件                                                                 | L1 | L2 | L3 | SWE |
| ------------------------- | -------------------------------------------------------------------- | -- | -- | -- | --- |
| S1.2.A1      | コントラクトにアップグレードメカニズム (プロキシパターンなど) が実装されていることを検証します。 |    | ✓  | ✓  |     |
| S1.2.A2      | アップグレードプロセスには認可されていないアップグレードに対するセーフガードを含んでいることを確認します。 |    | ✓  | ✓  |     |
| S1.2.A3      | アップグレードメカニズムは文書化され、セキュリティがレビューされていることをチェックします。 |    | ✓  | ✓  |     |
| S1.2.A4      | プロキシのアップグレード時に実装間で不変変数が一貫しており、誤用を防いでいることを検証します。 |    |    | ✓  |     |
| S1.2.A5      | プロキシのセットアップで実装コントラクトの `selfdestruct` および `delegatecall` が脆弱性や予期しない動作をもたらさないことを検証します。 |    |    | ✓  |     |
| S1.2.A6      | UUPSUpgradeable コントラクトが初期化されていない実装コントラクトに影響を及ぼす可能性のある脆弱性から保護され、安全なアップグレードメカニズムを確保していることを検証します。 |    |    | ✓  |     |

### S1.2.B 非推奨の管理 (Managing Deprecation)

| **SCSVS&nbsp;VR&nbsp;ID** | 要件                                                                 | L1 | L2 | L3 | SWE |
| ------------------------- | -------------------------------------------------------------------- | -- | -- | -- | --- |
| S1.2.B1      | 非推奨のコントラクトバージョンが正しくマークされ、処理されていることを検証します。 |    |    | ✓  |     |
| S1.2.B2      | 非推奨バージョンへのアクセスが制限または無効にされていることを確認します。  |    |    | ✓  |     |
| S1.2.B3      | 非推奨バージョンから新しいバージョンへの移行パスが安全であることをチェックします。 |    |    | ✓  |     |

### S1.2.C 透過プロキシと非透過プロキシ (Transparent vs. Opaque Proxies)

| **SCSVS&nbsp;VR&nbsp;ID** | 要件                                                                 | L1 | L2 | L3 | SWE |
| ------------------------- | -------------------------------------------------------------------- | -- | -- | -- | --- |
| S1.2.C1      | 透過プロキシと非透過プロキシのどちらが使用されているか、およびそれがコントラクトに適しているかどうかを検証します。 |    | ✓  | ✓  |     |
| S1.2.C2      | プロキシパターンが正しく実装され、脆弱性をもたらさないことを確認します。    |    | ✓  | ✓  |     |
| S1.2.C3      | プロキシパターンの選択が文書化され、正当化されていることをチェックします。  |    | ✓  | ✓  |     |
| S1.2.C4      | 初期化されていないコントラクトが攻撃者に乗っ取られないようにし、初期化関数が正しい修飾子で保護されていることを確認します。 |    |    | ✓  |     |
| S1.2.C5      | `TransparentUpgradeableProxy` および同様のプロキシパターンがセレクタの衝突とデコード不可能なコールデータを正しく処理して透過性を維持していることを検証します。 |    |    | ✓  |     |
